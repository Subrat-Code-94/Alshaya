/* eslint-disable */
import*as e from"/scripts/aem.js";var t,a={679:(t,a,n)=>{n.d(a,{A:()=>xe});var s=n(540),r=n(338);function o(){return document.documentElement.lang||"en"}window.configsPromises={};function i(e){const t=function(){const{location:e}=window;return"about:srcdoc"===e.href?window.parent.location.origin:e.origin}();return new URL(`${t}/${e?`${e}/`:""}configs.json?sheet=prod`)}const c=async e=>{const t="prod";window.configsPromises?.[t]||(window.configsPromises[t]=(async()=>{const e=o();let t=window.sessionStorage.getItem("config"),a=window.sessionStorage.getItem(`config:${e}`);if(!t||!a){const n=fetch(i()),s=fetch(i(e));try{const r=await Promise.all([n,s]);[t,a]=await Promise.all(r.map((e=>e.text()))),window.sessionStorage.setItem("config",t),window.sessionStorage.setItem(`config:${e}`,a)}catch(e){console.error("no config loaded",e)}}const n=JSON.parse(t);a&&JSON.parse(a).data.forEach((e=>{const t=n.data.find((t=>t.key===e.key));t?t.value=e.value:n.data.push(e)}));return n})());const a=(await window.configsPromises[t]).data;return a.find((t=>t.key===e))?.value};async function l(e,t=!1){try{return async function(e,t=!1){const a={"Content-Type":"application/json"};t&&(a.Authorization=`Bearer ${m()}`);const n=new URL(e),s=await fetch(n,{method:"GET",headers:a}),r={success:!!s.ok,status:s.status,message:s.statusText,data:await s.json()};return r.data?.message&&(r.message=r.data.message),r}(e,t)}catch(e){return console.error("Error fetching data",e),{success:!1,message:e.message}}}async function d(e,t,a=!1,n="POST"){try{return async function(e,t,a=!1,n="POST"){const s={"Content-Type":"application/json"};a&&(s.Authorization=`Bearer ${m()}`);const r=new URL(e);if(t){const e=await fetch(r,{method:n,headers:s,body:JSON.stringify(t)}),a={success:!!e.ok,status:e.status,message:e.statusText,data:await e.json()};return a.data?.message&&(a.message=a.data.message),a}const o=await fetch(r,{method:n,headers:s}),i={success:!!o.ok,status:o.status,message:o.statusText,data:await o.json()};return i.data?.message&&(i.message=i.data.message),i}(e,t,a,n)}catch(e){return console.error("Error fetching data",e),{success:!1,message:e.message}}}function m(){return function(e){let t;return document.cookie.split(";").forEach((a=>{const[n,s]=a.trim().split("=");n===e&&(t=decodeURIComponent(s))})),t}("auth_user_token")??""}const u=e=>{let t=null;const a=window.localStorage.getItem(e);if(a)try{t=JSON.parse(a).value.replaceAll('"',"")}catch(e){console.error("Error parsing JSON from local storage",e)}return t},p={CART_STEP:1,LOGIN_STEP:2,CHECKOUT_STEP:3,CONFIRMATION_STEP:4},_={moveToFav:"Move to favorites",promoBtn:"Done",productArtNo:"Art. no.",productColorLabel:"Color label",productSize:"Size",excludingDelivery:"Excluding delivery",deleteSuccess:"The product has been removed from your basket",inclusiveVat:"Inclusive of VAT",deleteitempopupmessage:"Do you want to move this item to favorites?",itemmovetofavtext:"Yes, Move to favorites",itemremovetext:"No, remove it",emptyCartMessage:"Your shopping bag is empty",emptyCartFavMessage:"Here are some of our favorites",productPriceSaveLabel:"save",orderSummaryTitle:"Order Summary",subTotalLabel:"Subtotal",discountsLabel:"Discounts",orderTotalLabel:"Order Total",bagUpdatedSuccessLabel:"Your bag has been updated successfully",quantityNotAvailableLabel:"The requested quantity is not available",deliveryMethodTitle:"Delivery method",homeDelivery:"Home Delivery",clickCollect:"Click & Collect",bagLabel:"Bag",signInLabel:"Sign In",deliveryPaymentLabel:"Delivery & Payment",confirmationLabel:"Confirmation",promotionLabel:"Do you have a Promotional Code?",promotionInputPlaceholder:"Promo code",promotionApplyButtonLabel:"Apply",promotionAppliedButtonLabel:"Applied",promotionRequiredValidationErrorMessage:"Please enter a promotional code",promotionDiscountAndVouchersLabel:"Discounts & Vouchers",promotionInvalidCodeMessage:"Sorry, this code is invalid. Please enter a valid promotional code.",discountLabel:"Discount",bonusVouchers:"Bonus Vouchers",memberOffers:"Member Offers",clearAllText:"CLEAR ALL",applyOffersText:"APPLY OFFERS",applyVouchersText:"APPLY VOUCHERS",checkoutAsGuest:"Checkout as a Guest",backToBasket:"Back to basket",sepratorOrLabel:"OR",signInEmail:"sign in with email address",signInSocial:"sign in with social media",checkoutBtn:"Continue to Checkout",outOfStockContent:"This product is out of stock",outOfStockToast:"Sorry, one or more products in your bag are no longer available. Please review your bag in order to checkout securely.",shippingMethodFreeLabel:"FREE",changeDeliveryAddressCta:"Change",confirmationSentTo:"Confirmation sent to:",orderNumber:"Order Number:",transacioId:"Transaction ID:",paymentId:"Payment ID:",resultCode:"Result Code:",orderDetail:"Order Detail",deliveryTo:"Delivery to:",billingAddress:"Billing Address:",mobileNumber:"Mobile Number:",paymentMethod:"Payment Method:",deliveryType:"Delivery Type:",expecteDeliveryWithin:"Expected Delivery Within:",numberOfItems:"Number of Items:",auraPointsEarned:"Aura Points Earned:",homeDeliveryTitle:"Free delivery on all orders above QAR 199.",clickCollectTitle:"Order now & collect from store of your choice",clickCollectDisabled:"Collect your order in-store is unavailable",deliveryInformationTitle:"Delivery Information",deliveryInformationBtnText:"Please add your contact details and address → →",deliveryInformationModalTitle:"Delivery Information",collectionStoreTitle:"Collection Store",collectionStoreBtnText:"Select your preferred collection store",styleText:"Style",sendToText:"Send to",customMessageEgift:"Message",egiftcardtext:"eGift Card",egiftGetcode:"Get Code",egiftCardInputTitle:"eGift Card Number",cashOnDeliveryLabel:"Cash on delivery service charge",egiftCardInputPlaceholder:"Enter verification code",discountTooltipMessageApplied:"Discount applied",discountTooltipMessageMemberDiscount:"Member Discount",discountTooltipMessageAdvantageCardDiscount:"Advantage Card Discount",memberOffersApplied:"Member offers applied",bonusVouchersApplied:"Bonus voucher applied",bonusVouchersExpiresOn:"Expires On",bonusVoucherAppliedLabel:"voucher applied",paymentMethodsTitle:"Payment Methods",freeGiftLabel:"Free gift with Purchase"},h={isLoggedIn:!1,cart:{cartId:null,data:{},isLoading:!1,isError:!1,oosDisable:!1,isCheckoutFlag:!0},promotion:{isApplyingPromoCode:!1,isRemovingPromoCode:!1,errorMessage:"",data:{}},activeProgressStep:1,store:null,deliveryInformation:{isDialogOpen:!1,isModalVisible:!1,isLoadingShippingMethods:!1,shippingMethods:[],changeAddress:""},userAddressList:[],editAddress:{}},v=(0,s.createContext)(h);function y(e){const[t,a]=(0,s.useState)(h.cart),[n,r]=(0,s.useState)(!!m()),[o,i]=(0,s.useState)(h.cart.cartId),[l,d]=(0,s.useState)(e?.placeholders),[_,y]=(0,s.useState)(h.activeProgressStep),[g,b]=(0,s.useState)(h.store),[f,E]=(0,s.useState)(h.store),[w,N]=(0,s.useState)(h.promotion),[k,C]=(0,s.useState)(h.deliveryInformation),[S,A]=(0,s.useState)(h.deliveryInformation),[I,x]=(0,s.useState)(h.cart.oosDisable),[T,M]=(0,s.useState)(h.cart.isCheckoutFlag),[P,L]=(0,s.useState)(h.cart.editAddress),O=t?.data?.items?.filter((e=>"1"!==e?.extensionAttributes?.extension_attributes?.is_egift&&!e?.extensionAttributes?.extension_attributes?.is_free_gift&&e?.extensionAttributes?.extension_attributes?.error_message)),D=t?.data?.items?.filter((e=>"1"!==e?.extensionAttributes?.extension_attributes?.is_egift&&!e?.extensionAttributes?.extension_attributes?.is_free_gift&&e?.isQuantityNotAvailable));return(0,s.useEffect)((()=>{switch(window.location.pathname){case`/${document.documentElement.lang}/cart`:y(p.CART_STEP);break;case`/${document.documentElement.lang}/cart/login`:if(n){window.location.assign(`/${document.documentElement.lang}/checkout`);break}window.location.search!==`?redirect=/${document.documentElement.lang}/checkout`&&window.location.assign(`/${document.documentElement.lang}/cart/login?redirect=/${document.documentElement.lang}/checkout`),y(p.LOGIN_STEP);break;case`/${document.documentElement.lang}/checkout`:y(p.CHECKOUT_STEP);break;case`/${document.documentElement.lang}/confirmation`:y(p.CONFIRMATION_STEP);break;default:y(p.CART_STEP)}}),[n]),(0,s.useEffect)((()=>{d(e?.placeholders)}),[e?.placeholders]),(0,s.useEffect)((()=>{r(!!m())}),[m]),(0,s.useEffect)((()=>{const e=u("M2_VENIA_BROWSER_PERSISTENCE__cartId");i(e);const a=t?.data?.id??null;a&&i(a)}),[i,n,t]),(0,s.useEffect)((()=>{(async()=>{const e=await c("cart-price-decimals"),t=await c("cart-show-free-returns");b(e),E("true"===t)})()}),[]),(0,s.useEffect)((()=>{x(O?.length>0||D?.length>0||!T)}),[t,I,T]),s.createElement(v.Provider,{value:{isLoggedIn:n,cartId:o,cart:t,setCart:a,placeholders:l,activeProgressStep:_,setActiveProgressStep:y,priceDecimals:g,promotion:w,setPromotion:N,deliveryInformation:k,setDeliveryInformation:C,userAddressList:S,setUserAddressList:A,cartShowFreeReturns:f,oosDisableButton:I,setOOSDisableButton:x,setIsCheckoutFlag:M,isCheckoutFlag:T,editAddress:P,setEditAddress:L}},e?.children)}const g=v;const b=(e=>{var t={};return n.d(t,e),t})({decorateIcons:()=>e.decorateIcons,toCamelCase:()=>e.toCamelCase}),f=(e,t)=>{const a=[];return t===e.id&&a.push("active"),e.isClickable&&e.id!==t&&a.push("clickable"),e.id<t&&a.push("completed"),a};const E=function(){const{activeProgressStep:e,placeholders:t,isLoggedIn:a}=(0,s.useContext)(g),n=(0,s.useRef)(null),r=`cart/login?redirect=/${document.documentElement.lang}/checkout`,o=[{id:1,label:t?.bagLabel,isClickable:!0,url:`/${document.documentElement.lang}/cart`},{id:2,label:t?.signInLabel,isClickable:!(a&&3===e),url:`/${document.documentElement.lang}/${a?"checkout":r}`},{id:3,label:t?.deliveryPaymentLabel,isClickable:a,url:`/${document.documentElement.lang}/checkout`},{id:4,label:t?.confirmationLabel,isClickable:!1}],i=t=>t<e?s.createElement("span",{className:"icon icon-tick-complete"}):t;return(0,s.useEffect)((()=>{n&&n.current&&(0,b.decorateIcons)(n.current)}),[e]),s.createElement("div",{ref:n,className:"progress__bar-container"},o.map((t=>s.createElement("div",{key:t.id,className:`progress__bar-item ${f(t,e).join(" ")}`},s.createElement("div",{className:"progress__bar-item-number"},s.createElement("div",{className:"progress__bar-item-number-wrapper"},t.isClickable&&t.id!==e?s.createElement("a",{className:"progress__bar-item-number-div",href:t.url},s.createElement("div",{className:"progress__bar-item-check-wrapper"},i(t.id))):s.createElement("div",{className:"progress__bar-item-number-div"},s.createElement("div",null,i(t.id))))),s.createElement("div",{className:"progress__bar-item-label-wrapper"},t.isClickable&&t.id!==e?s.createElement("a",{className:"progress__bar-item-label",href:t.url},t.label):s.createElement("div",{className:"progress__bar-item-label"},t.label))))))},w="web";function N(){const e=window.location.href;return e.includes("/cart")?"cart":e.includes("/checkout")?"checkout":""}async function k(e,t=!1,a="GET",n=null,s="V1"){let r=null;try{const o={method:a,headers:{"Content-Type":"application/json",Store:await c("commerce-store-view-code"),"Alshaya-Channel":w}};if(t){const e=m();e&&(o.headers.Authorization=`Bearer ${e}`)}!n||"POST"!==a&&"PUT"!==a||(o.body=JSON.stringify(n));const i=await c("commerce-rest-endpoint"),l=await c("commerce-store-view-code"),d=await fetch(`${i}/${l}/${s}/${e}`,o);r=await d.json(),d.data?.message&&(r.message=d.data.message)}catch(e){console.error(e)}return{response:r}}async function C(e,t={},a=!1){let n=null;try{const s=m(),r={method:"POST",headers:{"Content-Type":"application/json",Store:await c("commerce-store-view-code"),"Alshaya-Channel":w,"Alshaya-Page-Identifier":N(),"Alshaya-Country-Code":await c("country-code"),...s?{Authorization:`Bearer ${s}`}:{}},body:JSON.stringify({query:e,variables:t})},o=a?await c("cart-mesh-endpoint"):await c("commerce-endpoint"),i=await fetch(o,r);n=await i.json(),i.data?.message&&(n.message=i.data.message)}catch(e){console.error(e)}return{response:n}}const S="\n    extension_attributes {\n            delivery_matrix {\n            product_sku\n                applicable_shipping_methods {\n                    available\n                    carrier_code\n                    carrier_title\n                    cart_page_title\n                    error_message\n                    method_code\n                    method_title\n                }\n            }\n            cart {\n                id\n                applied_rule_ids\n                billing_address {\n                    firstname\n                    lastname\n                    email\n                    telephone\n                    street\n                    city\n                    region\n                    postcode\n                    region_id\n                    region_code\n                    country_id\n                    custom_attributes {\n                        attribute_code\n                        value\n                        name\n                    }\n                }\n                items {\n                    item_id\n                    sku\n                    qty\n                    name\n                    price\n                    product_type\n                    quote_id\n                    extension_attributes {\n                        item_name_en\n                        parent_product_sku\n                        error_message\n                        style_code\n                        color\n                        size\n                        season_code\n                        is_aura_free_item\n                        is_free_gift\n                        brand_full_name\n                        original_price\n                        egift_options {\n                            hps_giftcard_amount\n                            hps_giftcard_sender_name\n                            hps_giftcard_recipient_name\n                            hps_giftcard_sender_email\n                            hps_giftcard_recipient_email\n                            hps_giftcard_message\n                        }\n                        hps_style_msg\n                        image_url\n                        is_egift\n                        is_topup\n                        product_media {\n                            id\n                            media_type\n                            label\n                            position\n                            disabled\n                            types\n                            file\n                        }\n                    }\n                }\n                extension_attributes {\n                    free_shipping_text\n                    attempted_payment\n                    applied_rule_ids\n                    applied_rule_ids_with_discount\n                    is_locked\n                    is_multi_brand_cart\n                    applied_hm_offer_code\n                    hm_voucher_discount\n                    applied_hm_voucher_codes\n                    surcharge {\n                        is_applied\n                        amount\n                    }\n                    member_price_discount\n                    aura_promotion_discount\n                    has_exclusive_coupon\n                    shipping_assignments {\n                        shipping {\n                            address {\n                                firstname\n                                lastname\n                                email\n                                telephone\n                                street\n                                city\n                                region\n                                postcode\n                                region_id\n                                region_code\n                                country_id\n                                custom_attributes {\n                                    attribute_code\n                                    value\n                                    name\n                                }\n                            }\n                            method\n                        }\n                    }\n                }\n            }\n            totals {\n            total_segments{\n                    code\n                    title\n                    value\n                }\n               shipping_incl_tax\n                coupon_code\n                extension_attributes {\n                    coupon_label\n                    reward_points_balance\n                    reward_currency_amount\n                    base_reward_currency_amount\n                    is_hm_applied_voucher_removed\n                    is_all_items_excluded_for_adv_card\n                }\n                items {\n                    extension_attributes {\n                        adv_card_applicable\n                    }\n                }\n            }\n        }\n",A='\n    items {\n        id\n        uid\n        quantity\n        product {\n            promotions {\n                context\n                url\n                label\n                type\n            }\n            reserve_and_collect\n            ship_to_store\n            ... on commerce_SimpleProduct {\n                sku\n                dynamicAttributes(fields:["color","size"])\n                stock_data {\n                    qty\n                    max_sale_qty\n                    max_sale_qty_parent\n                }\n                stock_status\n            }\n            url_key\n            assets_cart\n            name\n            brand_full_name\n            sku\n            gtm_attributes{\n                id\n                name\n                variant\n                price\n                brand\n                category\n                dimension2\n                dimension3\n                dimension4\n            }\n        }\n        ... on commerce_ConfigurableCartItem {\n            configured_variant {\n                dynamicAttributes(fields:["color","size"])\n                reserve_and_collect\n                ship_to_store\n                name\n                sku\n                brand\n                price_range {\n                    maximum_price {\n                        regular_price {\n                            value\n                            currency\n                        }\n                        final_price {\n                            value\n                            currency\n                        }\n                        discount {\n                            percent_off\n                        }\n                    }\n                }\n                stock_data {\n                    qty\n                    max_sale_qty\n                    max_sale_qty_parent\n                }\n                stock_status\n                color_label\n                size\n            }\n            configurable_options {\n                option_label\n                value_id\n                value_label\n            }\n        }\n        prices {\n            row_total_including_tax {\n                value\n                currency\n            }\n        }\n    }\n',I="\n    prices {\n        grand_total {\n            value\n            currency\n        }\n        subtotal_excluding_tax {\n            value\n            currency\n        }\n        subtotal_including_tax {\n            value\n            currency\n        }\n        applied_taxes {\n            amount {\n                value\n                currency\n            }\n        }\n        discount {\n            amount {\n                value\n                currency\n            }\n            label\n        }\n    }\n",x={CART_QUERY__SHIPPING_ADDRESSES:"\n    shipping_addresses {\n        firstname\n        lastname\n        available_shipping_methods {\n        amount {\n            currency\n            value\n        }\n        available\n        carrier_code\n        carrier_title\n        method_code\n        method_title\n        error_message\n        price_excl_tax {\n            value\n            currency\n        }\n        price_incl_tax {\n            value\n            currency\n        }\n        }\n        selected_shipping_method {\n        amount {\n            value\n            currency\n        }\n        carrier_code\n        carrier_title\n        method_code\n        method_title\n        }\n    }\n",CART_QUERY__EXTENSION_ATTRIBUTE:S,CART_QUERY__ITEMS:A,CART_QUERY__PRICES:I,CART_QUERY:`\n    {\n        id\n        total_quantity\n        ${S}\n        ${A}\n        ${I}\n        available_payment_methods{\n          code\n          title\n        }\n        selected_payment_method{\n          code\n        }\n    }\n`,CHECKOUTCOM_CONFIG_QUERY:"\n    {\n        public_key\n        environment\n        allowed_card_types\n        mada_bin_numbers\n        display_card_number_type\n        apple_pay_merchant_id\n        apple_pay_merchant_capabilities\n        apple_pay_supported_networks\n        vault_enabled\n        cvv_check\n        api_url\n        fawry_expiry_time\n        benefit_pay_expiry_time\n    }\n"},T=e=>{const{isLoggedIn:t,cart:a,setCart:n,cartId:r}=(0,s.useContext)(g),o=t?`query customerCart {\n  commerce_customerCart ${x.CART_QUERY}\n}`:`query ($cartId: String!) {\n  commerce_cart(cart_id: $cartId) ${x.CART_QUERY}\n}`,i=(0,s.useCallback)((()=>{n({...a,isLoading:!0}),C(o,{cartId:r},!0).then((s=>{const r=t?s.response.data.commerce_customerCart:s.response.data.commerce_cart;r.items=r?.items?.map(((e,t)=>r?.extension_attributes?.cart?.items[t]?.extension_attributes?.is_free_gift?{...e}:Number(e?.quantity)<=Number(e?.configured_variant?.stock_data?.qty)?{...e,isQuantityNotAvailable:!1,extensionAttributes:r?.extension_attributes?.cart?.items?.find((t=>Number(e?.id)===Number(t?.item_id)))}:{...e,isQuantityNotAvailable:!0,extensionAttributes:r?.extension_attributes?.cart?.items?.find((t=>Number(e?.id)===Number(t?.item_id)))})),n({...a,data:r}),window.dispatchEvent(new CustomEvent("updateMiniCart")),1===e&&window.dispatchEvent(new CustomEvent("react:datalayerViewCartEvent",{detail:{value:r?.prices?.grand_total?.value||0,currency:r?.prices?.grand_total?.currency||"",productData:r.items.map((e=>{const t=e?.product?.gtm_attributes;return{gtm:{"gtm-magento-product-id":t?.id||"","gtm-name":t?.name||"","gtm-brand":t?.brand||"","gtm-category":t?.category||"","gtm-variant":t?.variant||"","gtm-stock":"IN_STOCK"===e?.configured_variant?.stock_status?"in stock":"","gtm-price":t?.price||""},discount:{en:""},quantity:e.quantity}}))}}))})).catch((()=>{n({...a,isError:!0,isLoading:!1})}))}),[t,r,n,a]);return(0,s.useEffect)((()=>{r&&i()}),[r]),null};function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},M.apply(this,arguments)}const P=function({name:e,id:t,className:a,onIconClick:n}){const r=(0,s.useRef)();return(0,s.useEffect)((()=>{r?.current&&(0,b.decorateIcons)(r.current)}),[]),s.createElement("div",M({ref:r},t?{id:t}:{},a?{className:a}:{}),s.createElement("span",M({},n?{onClick:n}:{},{className:`icon icon-${e}`})))};const L=function({isDisabled:e,id:t,value:a,icon:n,subTitle:r,subTitleRight:o,title:i,selectedMethod:c,handleDeliveryMethodChange:l,name:d,className:m,info:u}){return s.createElement("div",{key:t,className:`checkout__methods-option ${m??""} ${e?"disabled":""}`},s.createElement("input",{id:`delivery-method-${a}`,name:d,type:"radio",value:a,className:"radio-checked",disabled:e,checked:c===a,onChange:l}),s.createElement("div",{className:"checkout__methods-label"},n&&s.createElement(P,{name:n,className:"icon-wrapper"}),s.createElement("div",{className:"checkout__methods-description"},s.createElement("div",{className:"checkout__methods-type"},s.createElement("span",null,r),o&&s.createElement("span",null,o)),s.createElement("span",{className:"checkout__methods-title"},i),u&&s.createElement("span",{className:"checkout__methods-info"},u))))};const O=function(){const e=(0,s.useRef)(null);return(0,s.useEffect)((()=>{e.current&&(0,b.decorateIcons)(e.current)}),[]),s.createElement("div",{className:"loading-spinner",ref:e},s.createElement("span",{className:"icon icon-ic-loader"}))},D=async(e,t,a)=>{const n=a?"carts/mine/estimate-shipping-methods":`guest-carts/${t}/estimate-shipping-methods`;let s={};try{const t=await k(n,a,"POST",e);s=t?.response}catch(e){}return s},$=async(e,t,a)=>{const n=a?"carts/mine/updateCart":`guest-carts/${t}/updateCart`;let s={};try{const t=await k(n,a,"POST",e);s=t?.response,window.dispatchEvent(new CustomEvent("updateMiniCart"))}catch(e){}return s};const q=function({shippingAddress:e,placeholders:t,handleChangeClick:a,handleSelectClick:n,handleEditClick:r}){const{changeDeliveryAddressCta:o,addressSelectButton:i}=t;return s.createElement("div",{className:"delivery-information__header"},s.createElement("div",{className:"delivery-information__header__customer-info"},s.createElement("span",{className:"delivery-information__customer-name"},`${e?.firstname} ${e?.lastname}`),s.createElement("div",{className:"delivery-information__header__customer-address"},e?.email?s.createElement("span",{className:"mobile-only"},e.email):null,e?.telephone?s.createElement("span",{className:"mobile-only"},e.telephone):null,(()=>{const t={city:e?.city,street:e?.street?.join(", "),building:e?.custom_attributes?.find((e=>"address_building_segment"===e.attribute_code))?.value,address:e?.custom_attributes?.find((e=>"address"===e.attribute_code))?.value},a=Object.keys(t).map((e=>t[e])).filter((e=>e?.trim())).join(", ");return a?s.createElement("span",null,a):null})())),s.createElement("div",{className:"delivery-information__header__action"},a?s.createElement("button",{type:"button",className:"secondary",onClick:a},o):s.createElement(s.Fragment,null,s.createElement("button",{type:"button",className:"secondary",onClick:n},i),r?s.createElement("button",{type:"button",className:"secondary edit-btn",onClick:r,"aria-label":"Edit address"},s.createElement(P,{name:"edit-bottom-border",className:"edit-address"})):null)))};function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},R.apply(this,arguments)}const F=({isVisible:e,onClose:t})=>{const{placeholders:a,cartId:n,isLoggedIn:r,cart:o,setCart:i,deliveryInformation:l,setDeliveryInformation:d,userAddressList:m,editAddress:u,setEditAddress:p}=(0,s.useContext)(g),[_,h]=(0,s.useState)(!0),[v,y]=(0,s.useState)(!1),[b,f]=(0,s.useState)(!0),{deliveryInformationModalTitle:E="",changeAddressModalTitle:w="",addNewAddress:N=""}=a;(0,s.useEffect)((()=>{y(!m?.length)}),[m]),(0,s.useEffect)((()=>{if(v){C(!u)}else h(!1)}),[_]);const k=(e,t={})=>{f(e),p(t),y(!0),h(!0)},C=async(e=!0)=>{const t=document.getElementById("checkout-home-delivery"),n={endpoint:await c("apimesh-endpoint")};window.dispatchEvent(new CustomEvent("react:loadAddressForm",{detail:{targetSelector:t,placeholder:a,newCustomer:!0,isCheckoutPage:!0,address:e?{}:u,isLoggedIn:r,config:n}}))};(0,s.useEffect)((()=>{const e=()=>{h(!1)},a=async e=>{if("billing"===l.changeAddress){const a=S(e.detail);return await I(null,a,l.changeAddress),void(t&&t())}A(e.detail)};return window.addEventListener("react:addressFormLoaded",e),window.addEventListener("react:addressFormSubmitted",a),()=>{window.removeEventListener("react:addressFormLoaded",e),window.removeEventListener("react:addressFormSubmitted",a)}}),[]);const S=e=>{const t=e?.address?.custom_attributes?.find((e=>"address"===e.attribute_code));let a=e?.address?.custom_attributes||[];t||(a=[...e?.address?.custom_attributes,{attribute_code:"address",name:"address",value:e?.address?.address}]);const{country_code:n,id:s,customer_id:r,...o}=e.address;return{address:{...o,country_id:n||o.country_id,street:[o.street],custom_attributes:a}}},A=async e=>{const a=S(e),s=await D(a,n,r);d({...l,shippingMethods:s??[]});const o=s.find((e=>e.available))??null;await I(o,a,"shipping"),await I(null,a,"billing"),t&&t()},I=async(e,t,a)=>{const s=(e,a,n={})=>({[e]:{..."shipping"!==e&&t.address,...n},extension:{action:a}});let o;if("billing"===a)o=s("billing","update billing");else{if(!e)return;{const{carrier_code:a,method_code:n}=e;o=s("shipping","update shipping",{shipping_carrier_code:a,shipping_method_code:n,shipping_address:{...t.address}})}}const c=await $(o,n,r);"success"===c?.response_message?.[1]&&i((e=>({...e,data:{...e.data,extension_attributes:{...e.data.extension_attributes,cart:{...e.data.extension_attributes.cart,billing_address:c.cart?.billing_address,extension_attributes:{...e.data.extension_attributes.cart.extension_attributes,shipping_assignments:c.cart?.extension_attributes?.shipping_assignments}}}}})))};if(!e)return null;const x=m&&!v,T=!x&&r;return s.createElement(s.Fragment,null,s.createElement("div",{className:"dialog-heading"},s.createElement("h2",null,T&&s.createElement(P,{name:"arrow-left",className:"dialog-back-icon hidden",onIconClick:()=>{}}),x?w:E)),_&&s.createElement("div",{className:"dialog-loader"},s.createElement(O,null)),x?s.createElement("div",{className:"delivery-information__address-container"},s.createElement("button",{className:"secondary delivery-information__new-address",onClick:()=>k(!0)},N),s.createElement("div",{className:"delivery-information__address-list"},m.length?m.map((e=>s.createElement(q,R({key:e.id,shippingAddress:e,placeholders:a,handleSelectClick:a=>(async(e,a)=>{document.querySelector(".delivery-information__address-list").querySelectorAll("button").forEach((e=>e.setAttribute("disabled","true"))),e.target.classList.add("loader");const{region:n,street:s,id:r,...o}=a,i={address:{...o,street:s}};if("billing"===l.changeAddress)return i.address.customer_address_id=r,await I(null,i,l.changeAddress),void(t&&t());await A(i)})(a,e)},"billing"!==l.changeAddress&&{handleEditClick:()=>k(!1,e)})))):null)):s.createElement("div",{id:"checkout-home-delivery",className:"dialog-form"}))};const U=function({isOpen:e,children:t,onClose:a,containerClassName:n,headerClassName:r,bodyClassName:o}){const i=`dialog__container ${n??""}`.trim(),c=`dialog__header ${r??""}`.trim(),l=`dialog__body ${o??""}`.trim();return e?s.createElement("div",{className:"dialog__overlay"},s.createElement("div",{className:i},s.createElement("div",{className:c},s.createElement(P,{onIconClick:e=>{e.stopPropagation(),a()},name:"close",className:"icon-close-wrapper"})),s.createElement("div",{className:l},t))):null};class j{constructor(){this.type="guest",this.customer=null}static DEFAULT_CUSTOMER={firstname:"",lastname:"",email:""};static load(){m()&&(this.type="customer")}getCustomer(){return this.isGuest||this.customer?this.customer:j.DEFAULT_CUSTOMER}setCustomer(e){this.customer=e,this.type="customer"}isGuest(){return"guest"===this.type}}const V=new j;async function H(e){return`${await c("commerce-rest-endpoint")}/${await c("commerce-store-view-code")}/V1/${e}`}async function Q(e=!0){if(!m())return null;if(e&&V.customer)return V.customer;const t=await H("customers/me"),{data:a,success:n,message:s,status:r}=await l(t,!0);return n?(V.setCustomer(a),a):(console.error("Error fetching customer data",r,s),null)}const B=JSON.parse('{"data":{"storeLocationDetails":{"items":[{"id":372,"store_code":"RD1-3526-HEN","store_name":"Villagio","latitude":"25.259220","longitude":"51.443743","status":1,"website_id":21,"pudo_service":0,"sts_service":1,"sts_delivery_time_label":"1-2 days","rnc_service":0,"store_phone":"97444529648 ","store_email":"hnmmgr.vil-qtr@alshaya.com","address":[{"code":"firstname","value":"Naseem Abukar"},{"code":"lastname","value":""},{"code":"telephone","value":"97444529648 "},{"code":"street","value":"Villaggio Mall"},{"code":"address","value":"baaya street Al waab Doha"},{"code":"address_building_segment","value":""},{"code":"address_city_segment","value":"10053"},{"code":"area","value":"10059"}],"store_hours":[{"code":"2","label":"Sunday","value":"9 AM - 10 PM"},{"code":"5","label":"Monday","value":"9 AM - 10 PM"},{"code":"8","label":"Tuesday","value":"9 AM - 10 PM"},{"code":"11","label":"Wednesday","value":"9 AM - 10 PM"},{"code":"14","label":"Thursday","value":"9 AM - 11 PM"},{"code":"17","label":"Friday","value":"9 AM - 11 PM"},{"code":"20","label":"Saturday","value":"9 AM - 10 PM"}],"created_at":"2021-01-26 08:51:08","modified_at":"2021-01-26 08:51:08","store_id":42,"included_in_store":"","price_amount":"0.00","distance":null,"low_stock":null,"collection_point":null},{"id":379,"store_code":"RD1-3600-HEN","store_name":"Mall of Qatar","latitude":"25.326737","longitude":"51.349877","status":1,"website_id":21,"pudo_service":0,"sts_service":1,"sts_delivery_time_label":"1 - 2 days","rnc_service":0,"store_phone":"97444529048 ","store_email":"hnm.moq-qtr@alshaya.com","address":[{"code":"firstname","value":"Helen Edwards"},{"code":"lastname","value":""},{"code":"telephone","value":"97444529048 "},{"code":"street","value":"Alrayan , Doha Qatar"},{"code":"address","value":""},{"code":"address_building_segment","value":""},{"code":"address_city_segment","value":"10053"},{"code":"area","value":"10152"}],"store_hours":[{"code":"2","label":"Sunday","value":"10 AM - 10 PM"},{"code":"5","label":"Monday","value":"10 AM - 10 PM"},{"code":"8","label":"Tuesday","value":"10 AM - 10 PM"},{"code":"11","label":"Wednesday","value":"10 AM - 10 PM"},{"code":"14","label":"Thursday","value":"10 AM - 12 AM"},{"code":"17","label":"Friday","value":"1 PM - 12 AM"},{"code":"20","label":"Saturday","value":"10 AM - 11 PM"}],"created_at":"2021-02-14 08:20:08","modified_at":"2021-02-14 08:20:08","store_id":42,"included_in_store":"","price_amount":"0.00","distance":null,"low_stock":null,"collection_point":null},{"id":382,"store_code":"RD1-3711-HEN","store_name":"Doha Festival City  Family","latitude":"25.385092","longitude":"51.442139","status":1,"website_id":21,"pudo_service":0,"sts_service":1,"sts_delivery_time_label":"1 - 2 days","rnc_service":0,"store_phone":"97444529914 ","store_email":"hnmmen.dfc-qtr@alshaya.com","address":[{"code":"firstname","value":"Sherif Elsayed"},{"code":"lastname","value":""},{"code":"telephone","value":"97444529914 "},{"code":"street","value":"Umm salal Muhammed, Doha Qatar"},{"code":"address","value":""},{"code":"address_building_segment","value":""},{"code":"address_city_segment","value":"10053"},{"code":"area","value":"10077"}],"store_hours":[{"code":"2","label":"Sunday","value":"10 AM - 10 PM"},{"code":"5","label":"Monday","value":"10 AM - 10 PM"},{"code":"8","label":"Tuesday","value":"10 AM - 10 PM"},{"code":"11","label":"Wednesday","value":"10 AM - 10 PM"},{"code":"14","label":"Thursday","value":"10 AM - 11 PM"},{"code":"17","label":"Friday","value":"10 AM - 11 PM"},{"code":"20","label":"Saturday","value":"10 AM - 11 PM"}],"created_at":"2021-02-14 08:22:07","modified_at":"2021-02-14 08:22:07","store_id":42,"included_in_store":"","price_amount":"0.00","distance":null,"low_stock":null,"collection_point":null}],"total_count":3}}}');let z;const K=function(){const[e,t]=(0,s.useState)("list_view"),[a,n]=(0,s.useState)(null),[r,o]=(0,s.useState)(null),[i,l]=(0,s.useState)(null),[d,m]=(0,s.useState)(),[u,p]=(0,s.useState)(),[_,h]=(0,s.useState)(),v=(0,s.useRef)(null),y=(0,s.useRef)(null),g=(0,s.useRef)(null),b=e=>{t(e)},f=e=>{o(e.id),z.setCenter({lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)}),z.setZoom(12),g.current.setContent((e=>{let t="";return u[e.id].forEach((e=>{t=`${t}<div><span>${e.label}</span><span> (${e.value})</span></div>`})),`<div class="collection-map-infowindow">\n            <div class="collection-map-infowindow-title"><span class="collection-map-infowindow-name">${e.store_name}</span><span> 11.32 miles</span></div>\n            <div>Alrayan , Doha Qatar Doha Al Rayyan</div>\n            <div class="collection-map-infowindow-time"><span>Collect in store from</span><span> ${e.sts_delivery_time_label}</span></div>\n            <div>${t}</div>\n        </div>`})(e)),g.current.open(z,_[e.id])};async function E(){!document.getElementById("checkout-google-map")&&await(async()=>{const e=[`https://maps.googleapis.com/maps/api/js?key=${await c("sf-google-maps-key")}&async=true`];await Promise.all(e.map((e=>new Promise((t=>{const a=document.createElement("script");a.id="checkout-google-map",a.src=e,a.onload=t,a.type="module",document.head.appendChild(a)})))))})();const e=await window.google,t=await e.maps.importLibrary("marker"),{AdvancedMarkerElement:a}=t;if(!e)return;const n=await c("sf-maps-center-lat"),s=await c("sf-maps-center-lng"),r=await c("sf-maps-default-zoom-preference"),o=(await c("sf-maps-selection-zoom-preference"),{zoom:Number(r),center:new e.maps.LatLng(Number(n),Number(s)),mapId:"ALSHAYA_MAP_ID",disableDefaultUI:!0,zoomControl:!0});if(v?.current){new e.maps.Map(v.current,o)}y?.current&&(z=new e.maps.Map(y.current,o));const i={},l={};B.data.storeLocationDetails.items.forEach(((e,a)=>{l[e.id]=(e=>{let t,a=[];const n=[];return e.forEach(((s,r)=>{a.length||(a.push(s.label),t=s.value),t===s.value?a.splice(1,1,s.label):(n.push({label:a.join(" - "),value:t}),a=[],a.push(s.label),t=s.value),r===e.length-1&&n.push({label:a.join(" - "),value:t})})),n})(e.store_hours);const n=new t.AdvancedMarkerElement({position:{lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)},content:new t.PinElement({background:"#FFFFFF",borderColor:"#FF0000",glyph:a.toString(),glyphColor:"white"}).element,title:e.store_name});i[e.id]=n})),p(l),h(i),Object.values(i).forEach((e=>e.setMap(z))),g.current=new e.maps.InfoWindow}(0,s.useEffect)((()=>{"map_view"===e&&E()}),[e]);const w=e=>!!window.matchMedia(`(max-width: ${e})`).matches;return(0,s.useEffect)((()=>{E()}),[d]),(0,s.useEffect)((()=>{navigator.geolocation?.getCurrentPosition((e=>{const{latitude:t,longitude:a}=e.coords;m({currentLat:t,currentLng:a})})),l(w("767.5px")),window.addEventListener("resize",(()=>{l(w("767.5px"))}))}),[]),s.createElement("div",{className:"collection-store-main"},s.createElement("div",{ref:y,className:"collection-store-map-wrapper"}),s.createElement("div",{className:"collection-store-wrapper"},s.createElement("div",{className:"collection-store-title"},"Collection Store"),s.createElement("div",{className:"collection-store-content"},s.createElement("div",{className:"collection-store-warning"},s.createElement("div",{className:"collection-store-warning-icon"},s.createElement(P,{name:"warning"})),s.createElement("div",{className:"collection-store-warning-content"},s.createElement("div",{className:"collection-store-warning-title"},"You are browsing outside Kuwait."),s.createElement("div",{className:"collection-store-warning-desc"},"We currently don’t offer delivery outside Kuwait. Please enter an address within Kuwait below to proceed.Please select a store with in country Qatar below to continue."),s.createElement("a",{className:"collection-store-warning-action"},"Dismiss"))),s.createElement("div",{className:"collection-store-find-label"},"Find Your Nearest Store"),s.createElement("div",{className:"collection-store-input-container"},s.createElement("div",{className:"collection-store-input-div"},s.createElement("div",{className:"collection-store-input-wrapper"},s.createElement("div",{className:"collection-store-input-icon"},s.createElement(P,{name:"search"})),s.createElement("input",{className:"collection-store-input",type:"text",placeholder:"eg. Doha"}))),s.createElement("div",{className:"collection-store-location-icon"},s.createElement(P,{name:"locate"}))),s.createElement("div",{className:"collection-store-btn-container"},s.createElement("div",{className:"collection-store-btn-wrapper"},s.createElement("button",{className:"list_view"===e?"":"secondary",onClick:()=>b("list_view")},"List view"),s.createElement("button",{className:"map_view"===e?"":"secondary",onClick:()=>b("map_view")},"Map view"))),"list_view"===e&&s.createElement("div",{className:"collection-store-add-container"},s.createElement("ul",null,B.data.storeLocationDetails.items.map((e=>s.createElement("li",null,s.createElement("a",{onClick:()=>f(e),className:"collection-store-add-line"},s.createElement("div",{className:"collection-store-name-holder"},s.createElement("div",{className:"collection-store-name-radio"},s.createElement("input",{type:"radio",readOnly:!0,checked:r===e.id})),s.createElement("div",{className:"collection-store-name"},e.store_name)),s.createElement("div",{className:"collection-store-distance"},s.createElement("div",null,"5.25 miles"),i&&s.createElement("a",{onClick:()=>{return t=e.id,void n(t===a?null:t);var t}},s.createElement(P,{className:e.id===a?"caret-icon-div show":"caret-icon-div",name:"caret-up-fill"}),s.createElement(P,{className:e.id!==a?"caret-icon-div show":"caret-icon-div",name:"caret-down-fill"})))),i&&e.id===a&&s.createElement("div",{className:"collection-store-li-add"},s.createElement("div",null,"Alrayan , Doha Qatar Doha Al Rayyan"),s.createElement("div",{className:"collection-store-time"},s.createElement("span",null,"Collect in store from"),s.createElement("span",null," ",e.sts_delivery_time_label)),s.createElement("div",null,u[e.id].map((e=>s.createElement("div",null,s.createElement("span",null,e.label),s.createElement("span",null," ","(",e.value,")"))))))))))),"map_view"===e&&s.createElement("div",{ref:v,className:"collection-store-mobile-map"})),s.createElement("div",{className:"collection-store-submit"},s.createElement("button",null,"Select this store"))))};function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},G.apply(this,arguments)}const Y=function({onSelectedMethodChange:e}){const{placeholders:t,cart:a,isLoggedIn:n,deliveryInformation:r,setDeliveryInformation:o,setUserAddressList:i}=(0,s.useContext)(g),[l,d]=(0,s.useState)(!1),[m,u]=(0,s.useState)(!1),[p,_]=(0,s.useState)("home_delivery"),{deliveryMethodTitle:h="",homeDelivery:v="",clickCollect:y="",homeDeliveryTitle:b="",clickCollectTitle:f="",clickCollectDisabled:E="",deliveryInformationTitle:w="",deliveryInformationBtnText:N="",collectionStoreTitle:k="",collectionStoreBtnText:C=""}=t,S=a?.data?.items,A=a?.data?.extension_attributes?.cart?.extension_attributes?.is_multi_brand_cart??!1,I=!!a?.data?.extension_attributes?.cart?.extension_attributes?.shipping_assignments?.[0]?.shipping?.address?.firstname;(0,s.useEffect)((()=>{(async()=>{const e=await c("global-click-collect-disabled");u("true"===e)})(),(()=>{if(S&&!m){const e=S.some((e=>2===e?.configured_variant?.reserve_and_collect&&2===e?.configured_variant?.ship_to_store));d(e)}})();n&&(async()=>{const e=await Q();if(e){const t=e?.addresses?.find((t=>t.id===parseInt(e.default_shipping,10)));t&&i(e.addresses)}})()}),[S]);const x=t=>{const a=t.target.value;_(a),e(a)},T=()=>{o("home_delivery"===p?{...r,isDialogOpen:!0,isModalVisible:!0}:{...r,isDialogOpen:!0})},M=()=>o({...r,isDialogOpen:!1}),P=m||l||A,O=[{id:1,subTitle:v,title:b,icon:"home-delivery",value:"home_delivery"},{id:2,subTitle:y,title:P?E:f,icon:"click-collect",value:"click_and_collect",isDisabled:P}];return s.createElement(s.Fragment,null,s.createElement("div",{className:"checkout__delivery-methods-container"},s.createElement("div",{className:"checkout-title"},h),s.createElement("div",{className:"checkout__delivery-methods-wrapper"},O.map((e=>s.createElement(L,G({key:e.id,name:"delivery-method",selectedMethod:p,handleDeliveryMethodChange:x},e)))))),s.createElement("div",{className:"checkout__delivery-information"},s.createElement("div",{className:"checkout__delivery-information-title"},"home_delivery"===p?w:k),"home_delivery"===p&&!I&&s.createElement("button",{type:"button",className:"checkout__delivery-information-btn",onClick:T},N),"home_delivery"!==p&&s.createElement("button",{type:"button",className:"checkout__delivery-information-btn",onClick:T},C)),s.createElement(U,{isOpen:r.isDialogOpen,onClose:M,headerClassName:"dialog__header-checkout",containerClassName:"dialog__checkout-container"},"home_delivery"===p&&s.createElement(F,{isVisible:r.isModalVisible,onClose:M}),"click_and_collect"===p&&s.createElement(K,null)))},J=async(e,t=2)=>{let a=e||"";a||(a=await c("currency")||"AED");const n=await c("country-code")||"AE";return new Intl.NumberFormat(`${document.documentElement.lang||"en"}-${n}`,{style:"currency",currency:a,numberingSystem:"latn",maximumFractionDigits:t})};function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},W.apply(this,arguments)}const X=function(){const{cart:e,cartId:t,isLoggedIn:a,placeholders:n,deliveryInformation:r,setDeliveryInformation:o,setEditAddress:i}=(0,s.useContext)(g),[l,d]=(0,s.useState)(),[m,u]=(0,s.useState)([]),[p,_]=(0,s.useState)(""),h=r.shippingMethods,v=e?.data?.extension_attributes?.cart?.extension_attributes?.shipping_assignments?.[0]?.shipping,y=v?.address,b=async e=>{let t=n.shippingMethodFreeLabel;return e&&(t=await(async(e,t)=>(await J(e)).format(t))(p,e)),t};(0,s.useEffect)((()=>{(async()=>{if(h){const e=await Promise.all(h.filter((e=>"click_and_collect"!==e.method_code)).map((async(e,t)=>({id:t+1,title:e.method_title,subTitle:e.carrier_title,value:`${e.carrier_code}_${e.method_code}`,subTitleRight:await b(e.amount),info:e.error_message,isDisabled:!e.available}))));u(e)}})()}),[h]),(0,s.useEffect)((()=>{(async()=>{const e=await c("currency");_(e)})()}),[]),(0,s.useEffect)((()=>{(async()=>{if(y?.firstname){o({...r,isLoadingShippingMethods:!0});const e={address:y},n=await D(e,t,a);o({...r,shippingMethods:n??[],isLoadingShippingMethods:!1})}})()}),[y]),(0,s.useEffect)((()=>{d(v?.method)}),[v?.method]);const f=e=>{const t=e.target.value;d(t)};return y?.firstname||h?.length?s.createElement("div",{className:"checkout__delivery-information__wrapper"},y?.firstname?s.createElement(q,{shippingAddress:y,placeholders:n,handleChangeClick:()=>(i(y),void o({...r,isDialogOpen:!0,isModalVisible:!0,changeAddress:"shipping"}))}):null,r.isLoadingShippingMethods?s.createElement(O,null):h?.length&&s.createElement(s.Fragment,null,s.createElement("div",{className:"divider"}),(()=>{const e=m?.filter((e=>!e.isHidden))??[];return e.map(((t,a)=>s.createElement(s.Fragment,{key:`shipping-method-${t.id}`},s.createElement(L,W({className:"checkout__shipping-method-option",name:"shipping-method",selectedMethod:l,handleDeliveryMethodChange:f},t)),a<e.length-1&&s.createElement("div",{className:"divider"}))))})())):null},Z=async(e,t,a)=>{const n=`mutation updateCartItems($cartId: String!, $cartItemId: ID!, $quantity: Float!) {\n    commerce_updateCartItems(\n      input: {\n        cart_id: $cartId\n        cart_items: [{ cart_item_uid: $cartItemId, quantity: $quantity }]\n      }\n    ) {\n      cart ${x.CART_QUERY}\n    }\n  }`;let s=[];try{s=(await C(n,{cartId:t,cartItemId:e,quantity:a},!0)).response,window.dispatchEvent(new CustomEvent("updateMiniCart"))}catch(e){console.error("Error updating quantity:",e)}return s};const ee=function({isDisabled:e,totalQtyAvailable:t,orderedQty:a=1,qtyNotAvailable:n,isQtyAvailable:r,product:o,bagUpdatedSuccessLabel:i}){const{cart:c,cartId:l,setCart:d}=(0,s.useContext)(g),[m,u]=(0,s.useState)(!1),[p,_]=(0,s.useState)(!1),[h,v]=(0,s.useState)(a.toString()),y=(0,s.useRef)(null),f=(0,s.useRef)(null),E=(0,s.useRef)(null),w=(0,s.useRef)(null),N=e=>{y.current&&!y.current.contains(e.target)&&u(!1)};(0,s.useEffect)((()=>{f.current&&(0,b.decorateIcons)(f.current)}),[p]),(0,s.useEffect)((()=>(document.addEventListener("mousedown",N),()=>{document.removeEventListener("mousedown",N)})),[]);const k=(0,s.useCallback)((async(e,t)=>{const{uid:a}=o;u(!1),_(!0),window.dispatchEvent(new CustomEvent("react:resetPageMessage"));const s=await Z(a,l,+e);if(s?.data?.commerce_updateCartItems?.cart){const a=s.data.commerce_updateCartItems.cart?.items?.map((e=>{const a=t?.data?.items?.find((t=>e?.product?.sku===t?.product?.sku));return e?.product?.sku===o?.product?.sku?{...e,isQuantityNotAvailable:!1,extensionAttributes:s.data.commerce_updateCartItems?.cart?.extension_attributes?.cart?.items?.find((t=>Number(e?.id)===Number(t?.item_id)))}:{...e,isQuantityNotAvailable:a?.isQuantityNotAvailable,extensionAttributes:a?.extensionAttributes}}));s.data.commerce_updateCartItems.cart.items=a;const r=t?.data?.items?.find((e=>o?.product?.sku===e?.product?.sku));if(r&&e<r.quantity){const t=r?.product?.gtm_attributes;window.dispatchEvent(new CustomEvent("react:datalayerRemoveFromCartEvent",{detail:{quantity:r.quantity-e,productData:{gtm:{id:t?.id||"",name:t?.name||"",brand:t?.brand||"",category:t?.category||"",variant:t?.variant||"",price:t?.price||""},inStock:"IN_STOCK"===r?.configured_variant?.stock_status}}}))}d({...t,data:s.data.commerce_updateCartItems.cart}),window.dispatchEvent(new CustomEvent("react:showPageSuccessMessage",{detail:{message:i}})),n(!0);const c=document.getElementsByClassName("page-success-message");c&&c[0]&&c[0].scrollIntoView({behavior:"smooth",block:"start"})}else if(s.errors){const e=c?.data?.items?.map((e=>e?.product?.sku===o?.product?.sku?{...e,isQuantityNotAvailable:!0}:{...e}));d({...c,data:{...c?.data,items:e}}),n()}_(!1),v(e)}),[c]);return(0,s.useEffect)((()=>{if(m&&E.current&&w.current){const{offsetTop:e}=w.current,{offsetHeight:t}=w.current,a=e+t,n=E.current.clientHeight;E.current.scrollTop=a-n+10}}),[m]),s.createElement("div",{className:"qty-dropdown",ref:y},p?s.createElement(O,null):s.createElement(s.Fragment,null,s.createElement("button",{type:"button",ref:f,onClick:()=>{u(!m)},className:`qty-dropdown__toggle${r?"":"qty-dropdown__error"} ${e?"qty-dropdown-disabled":""}`},s.createElement("span",null,h),s.createElement("span",{className:"chevron"+(m?" open":"")},s.createElement("span",{className:"icon icon-chevron-down"}))),m&&s.createElement("div",{className:"qty-dropdown__menu",ref:E},(()=>{const e=[],a=+h>10||+h>+t?h:Math.min(+t,10);for(let n=1;n<=a;n+=1){let a="",r=!1;n===+h&&(a+="selected"),+t<n&&(a+=" disabled",r=!0),e.push(s.createElement("div",{role:"button",tabIndex:r?-1:0,key:n,className:a,onClick:()=>!r&&k(n,c),onKeyUp:e=>"Enter"===e.key&&!r&&k(n,c),ref:n===+h?w:null},n))}return e})())))},te="guestUserwishlistInfo";function ae(){const e=new Date;return new Date(e.getTime()+6048e5).getTime()}async function ne(){if(!m()){if(localStorage.getItem(te)){const t=JSON.parse(localStorage.getItem(te));return e=t.expiryTime,(new Date).getTime()>e?(localStorage.removeItem(te),{items:[]}):t.data}return{items:[]}}var e;const t=await c("commerce-rest-endpoint"),a=await c("commerce-store-view-code"),n=`${t}/${a}/V1/wishlist/me/get`,s=await l(n,!0),{data:r,success:o}=s;if(o){const e=r;if(e.items=[],e?.items_count>0){const n=`${t}/${a}/V1/wishlist/me/items`,s=await l(n,!0),{success:r,data:o}=s;r&&o?.items?.length>0&&(e.items=o.items)}return e}return{}}async function se(e,t=null){let a=t;t||(a=await ne());const n=a.items?.findIndex((t=>t.sku===e));return n}async function re(e,t,a){a||await async function(){const e=m();if(!e)return{};const t=`${await c("commerce-rest-endpoint")}/${await c("commerce-store-view-code")}/V1/wishlist/me/create`,a=await d(t,{name:"MyFavorites",visibility:!0},!!e),{data:n,success:s,message:r}=a;return s?{status:s,data:n,message:r}:(console.error(r),null)}();if(t){const t=`${await c("commerce-rest-endpoint")}/${await c("commerce-store-view-code")}/V1/wishlist/me/item/add`,a={items:[{sku:e.sku}]},n=await d(t,a,!0),{success:s,message:r,data:o}=n;if(!s||!o.status)return{status:s&&o.status,message:o.message}}else await async function(e){const t=ae(),a=await ne(),n=a?.items?.findIndex((t=>t.sku===e.sku));if(-1===n){a.items.push({sku:e.sku});const n={data:a,expiryTime:t};localStorage.setItem(te,JSON.stringify(n))}}(e);return document.querySelector("main").dispatchEvent(new CustomEvent("favourites-updated",{detail:{count:a.items.length,product:e,showSignIn:!0}})),{status:!0,message:"Product added to wishlist"}}async function oe(e,t,a){if(!t)return await async function(e){const t=ae(),a=await ne(),n=await se(e.sku,a);if(-1!==n){a.items.splice(n,1);const e={data:a,expiryTime:t};localStorage.setItem(te,JSON.stringify(e))}}(e),{status:!0,message:"Product removed from wishlist"};const n=await se(e.sku,a),{wishlist_item_id:s}=a.items[n],r=`${await c("commerce-rest-endpoint")}/${await c("commerce-store-view-code")}/V1/wishlist/me/item/${s}/delete`,o=await d(r,null,!0,"DELETE"),{message:i,success:l}=o;return{status:l,message:i}}const ie=async(e,t)=>{const a=`mutation removeItemFromCart($cartId: String!, $cartItemId: ID!) {\n      commerce_removeItemFromCart(\n        input: {\n          cart_id: $cartId,\n          cart_item_uid: $cartItemId\n        }\n      )\n      {\n        cart ${x.CART_QUERY}\n      }\n    }`;let n=[];try{n=(await C(a,{cartId:t,cartItemId:e},!0)).response.data.commerce_removeItemFromCart.cart,window.dispatchEvent(new CustomEvent("updateMiniCart"))}catch(e){console.error("Error removing item from cart:",e)}return n};const ce=function({onMoveToFav:e,onRemove:t,productImageUrl:a,isEgift:n,productSku:r,disabled:o,isFreeGift:i}){const[c,l]=(0,s.useState)(!1),d=(0,s.useRef)(null),m=()=>{ne().then((e=>{e&&e.items&&e.items.findIndex((e=>e.sku===r))>-1?t():l(!0)})).catch((()=>{l(!0)}))},{placeholders:u}=(0,s.useContext)(g);(0,s.useEffect)((()=>{c&&document.querySelector("#item-popup-modal")&&(0,b.decorateIcons)(document.querySelector("#item-popup-modal"))}),[c]),(0,s.useEffect)((()=>{d.current&&(0,b.decorateIcons)(d.current)}),[]);const p=()=>{l(!1)};return s.createElement("div",{className:"delete-item",ref:d},s.createElement("span",{className:`icon ${n||i||!o?"icon-trash-grey trash-grey":"icon-trash-red trash-red"} ${i?"icon-delete-disabled":""} icon-md`,onClick:n?t:m,onKeyUp:e=>"Enter"===e.key&&(n?t():m()),role:"button",tabIndex:0,"aria-label":"delete button"}),c&&s.createElement("div",{className:"delete_popup_overlay"},s.createElement("div",{className:"popup-delete"},s.createElement("div",{id:"item-popup-modal",className:"delete_popup_main"},s.createElement("span",{onClick:p,onKeyUp:e=>"Enter"===e.key&&p(),role:"button",tabIndex:0,className:"close_icon","aria-label":"close"},s.createElement("span",{className:"icon icon-close-icon"})),s.createElement("div",{className:"popup_body"},s.createElement("img",{src:a,alt:"item"}),s.createElement("div",{className:"item_confirmation"},s.createElement("p",null,u.deleteitempopupmessage))),s.createElement("div",{className:"popup_footer"},s.createElement("button",{type:"button",onClick:e,className:"move_to_fav_list"},u.itemmovetofavtext),s.createElement("button",{type:"button",onClick:t,className:"remove_from_cart"},u.itemremovetext))))))};const le=function({data:e,icon:t,content:a,isdisabled:n}){return s.createElement("div",{className:"delivery-method-info-container "+(n?"":"delivery-method-info-container-inactive")},s.createElement("span",{className:"delivery-method-info-label "+(n?"delivery-method-info-label--active":"delivery-method-info-label--inactive")},e),s.createElement("span",{className:`${t} iconInfo`}),s.createElement("span",{className:"delivery-method-info-value"},a))};const de=function({product:e,cart:t}){const a=(0,s.useRef)(null);(0,s.useEffect)((()=>{a.current&&(0,b.decorateIcons)(a.current)}),[]);const n=e?.product?.sku;return s.createElement("div",{className:"product-delivery-methods",ref:a},((e,t)=>{const a=t?.find((t=>t?.product_sku===e));return a&&a.applicable_shipping_methods?a.applicable_shipping_methods.map((e=>s.createElement("div",{className:`delivery-method delivery-method--${e.cart_page_title.toLowerCase()} ${e?.available?"delivery-method--active":"delivery-method--inactive"}`,key:e.method_code},s.createElement(le,{data:e.cart_page_title,icon:""+(e?.available?"icon icon-info":"icon icon-info-disabled"),content:e.method_title,isdisabled:e?.available})))):null})(n,t?.data?.extension_attributes?.delivery_matrix))},me=({price:e,priceDecimals:t,currency:a})=>{const[n,r]=(0,s.useState)("");return(0,s.useEffect)((()=>{(async()=>{const n=await J(a,t);r(n.format(e))})()}),[e]),n};const ue=function({product:e,currency:t,checkoutHideSection:a}){const[n,r]=(0,s.useState)(!0),[i,c]=(0,s.useState)(!1),{cart:l,setCart:d,placeholders:u,cartId:p,priceDecimals:_,promotion:h}=(0,s.useContext)(g),v=JSON.parse(e?.product?.assets_cart??"[]")[0],y=v?.styles?.cart_thumbnail??"",b=l?.data?.extension_attributes?.cart?.items?.find((t=>Number(e.id)===t?.item_id)),f=b?.extension_attributes,E="1"===f?.is_egift,w=f?.is_free_gift,N=f?.egift_options?.hps_giftcard_message,k=async t=>{c(!0);const{uid:a}=t;await async function(e,t){const a=m(),n=await ne();return t?t?oe(e,a,n):{status:!1,message:"Some error"}:re(e,a,n)}(t?.configured_variant,!1);const n=u?.deleteSuccess??"",s=await ie(a,p,n);if(e){const t=e?.product?.gtm_attributes;window.dispatchEvent(new CustomEvent("react:datalayerRemoveFromCartEvent",{detail:{quantity:e.quantity,productData:{gtm:{id:t?.id||"",name:t?.name||"",brand:t?.brand||"",category:t?.category||"",variant:t?.variant||"",price:t?.price||""},inStock:"IN_STOCK"===e?.configured_variant?.stock_status}}}))}window.addEventListener("favourites-widget-removed",(e=>{((e,t,a)=>{window.dispatchEvent(new CustomEvent("updateMiniCart")),d({...l,data:t});const n=t?.items?.length;n&&e?(window.dispatchEvent(new CustomEvent("react:showPageSuccessMessage",{detail:{message:a}})),document.querySelector(".page-success-message.visible").scrollIntoView({behavior:"smooth"})):window.dispatchEvent(new CustomEvent("react:resetPageMessage"))})(e.detail,s,n)}))},C=e?.configured_variant?.size??"",S=e?.configurable_options??"";let A="";C&&S&&(A=S.find((e=>e.value_id===C))?.value_label??"");const I=(0,s.useCallback)(((e=!1)=>{r(e)}),[]);(0,s.useEffect)((()=>{n||window.dispatchEvent(new CustomEvent("react:dataLayerCartErrorsEvent",{detail:{eventLabel:"quantity-not-available",eventAction:u?.quantityNotAvailableLabel||"The requested quantity is not available",eventPlace:`Error occured on ${window.location.href}`}}))}),[n]);const x=E?b?.price:e?.configured_variant?.price_range?.maximum_price?.regular_price?.value??0,T=E?b?.price:e?.configured_variant?.price_range?.maximum_price?.final_price?.value??0,M=e?.configured_variant?.price_range?.maximum_price?.discount?.percent_off??0,P=me({price:x,priceDecimals:_,currency:t}),L=me({price:T,priceDecimals:_,currency:t}),D=()=>(w?e?.product?.sku:e?.configured_variant?.sku)??"";(0,s.useEffect)((()=>{e.configured_variant?.stock_data?.qty&&e.configured_variant.stock_data.qty<e.quantity&&r(!1)}),[e]);const $=()=>{const t=w?e?.product?.dynamicAttributes:e?.configured_variant?.dynamicAttributes;return JSON.parse(t)};return(0,s.useEffect)((()=>{f?.error_message&&(window.dispatchEvent(new CustomEvent("react:showPageErrorMessage",{detail:{message:u?.outOfStockToast}})),window.dispatchEvent(new CustomEvent("react:dataLayerCartErrorsEvent",{detail:{eventLabel:"out-of-stock",eventAction:u?.outOfStockToast,eventPlace:`Error occured on ${window.location.href}`}})),document.querySelector(".page-error-message.visible").scrollIntoView({behavior:"smooth"}))}),[f?.error_message]),s.createElement("div",{className:"product-summary__card"},s.createElement("div",{className:"product-summary__container "+(i?"loader":"")},s.createElement("div",{className:"product-summary"},s.createElement("div",{className:"product-image "+(E?"egift-class":"")},s.createElement("img",{src:E?f?.image_url:y,alt:e?.product?.name??""})),s.createElement("div",{className:"product-info "+(E?"egift-spaces":"")},s.createElement("div",{className:"product-info-title-wrapper"},!E&&(()=>{const t=e?.product?.brand_full_name??"";return t?s.createElement("span",{id:"product-brand"},t):null})(),E?s.createElement("span",{id:"product-title"},u.egiftcardtext):s.createElement("a",{id:"product-title",href:`/${o()}/${e?.product?.url_key??""}`},e?.product?.name??""),s.createElement("div",{className:"product-info__price__discount"},s.createElement("span",{id:"price"},x!==T&&s.createElement("span",{style:{textDecoration:"line-through"}},P)," ",s.createElement("span",{className:x!==T?"price__discounted":""},L)),!E&&(()=>{const e=`(${u.productPriceSaveLabel} ${Math.round(M)}%)`;return x!==T?s.createElement("span",{id:"save-percentage"},e):null})())),E?s.createElement("div",{className:"product-info__sub eGift-info"},s.createElement("span",null,u.styleText,":"," ",f?.hps_style_msg),s.createElement("span",null,u.sendToText,":"," ",f?.egift_options?.hps_giftcard_recipient_email),N&&s.createElement("span",null,u.customMessageEgift,":"," ",N)):s.createElement("div",{className:"product-info__sub"},s.createElement("span",null,u?.productArtNo??"",":"," ",D()),s.createElement("span",null,u?.productColorLabel??"",":"," ",$()?.color_label??""),s.createElement("span",null,u?.productSize??"",":"," ",w?$()?.size_label:A??C)),!E&&!w&&!a&&s.createElement("button",{type:"button",id:"move-to-fav",onClick:()=>k(e)},u?.moveToFav??""))),!a&&s.createElement("div",{className:"product-summary__actions"},i?s.createElement(O,null):s.createElement(ce,{productImageUrl:y,onMoveToFav:()=>k(e),onRemove:()=>(async t=>{c(!0);const{uid:a}=t,n=u?.deleteSuccess??"",s=await ie(a,p,n);if(s.items=s?.items?.map((e=>Number(e?.quantity)<=Number(e?.configured_variant?.stock_data?.qty)?{...e,isQuantityNotAvailable:!1,extensionAttributes:s?.extension_attributes?.cart?.items?.find((t=>Number(e?.id)===Number(t?.item_id)))}:{...e,isQuantityNotAvailable:!0,extensionAttributes:s?.extension_attributes?.cart?.items?.find((t=>Number(e?.id)===Number(t?.item_id)))})),e){const t=e?.product?.gtm_attributes;window.dispatchEvent(new CustomEvent("react:datalayerRemoveFromCartEvent",{detail:{quantity:e.quantity,productData:{gtm:{id:t?.id||"",name:t?.name||"",brand:t?.brand||"",category:t?.category||"",variant:t?.variant||"",price:t?.price||""},inStock:"IN_STOCK"===e?.configured_variant?.stock_status}}}))}d({...l,data:s}),c(!1);const r=s?.items?.length;r?(window.dispatchEvent(new CustomEvent("react:showPageSuccessMessage",{detail:{message:n}})),document.querySelector(".page-success-message.visible").scrollIntoView({behavior:"smooth"})):window.dispatchEvent(new CustomEvent("react:resetPageMessage"))})(e),productSku:e?.configured_variant?.sku??"",isEgift:E,isFreeGift:w,disabled:f?.error_message||e?.isQuantityNotAvailable||w}),(!E&&e.configured_variant?.stock_data?.qty||w)&&s.createElement("div",{className:f?.error_message?"product-qty-update-disable":"product-qty-update"},s.createElement(ee,{isDisabled:w,totalQtyAvailable:e.configured_variant?.stock_data?.qty,orderedQty:e.quantity,qtyNotAvailable:I,isQtyAvailable:n,bagUpdatedSuccessLabel:u?.bagUpdatedSuccessLabel||"Your bag has been updated successfuly.",product:e})))),!E&&s.createElement("div",{className:"product-summary__footer"},(()=>{const t=e?.product?.promotions??[];return t?.length?s.createElement("div",{className:"product-offer-wrapper"},t.map((t=>s.createElement("a",{key:`${e?.product?.name??""}-${t?.label??""}`,href:`/${o()}/${t?.url??""}`,className:"product-offer"},t?.label??"")))):null})(),!a&&s.createElement(de,{product:e,cart:l})),w&&s.createElement("div",{className:"free_gift_container"},s.createElement("span",{className:"free_gift_label"},u?.freeGiftLabel)),!E&&f?.error_message&&s.createElement("div",{className:"product-label__container"},s.createElement("span",{className:"product-label"},f?.error_message||u?.outOfStockContent)),(()=>{const e=h?.data?.promoDynamicLabelCart?.products_labels??[],t=D();return(e.find((e=>e.sku===t))?.labels??[]).map((e=>s.createElement("div",{className:"product-label__container",key:`product-label-${t}-${e}`},s.createElement("span",{className:"product-label"},e.label))))})(),!E&&!n&&s.createElement("div",{className:"product-summary__qtyNotAvailable"},s.createElement("span",null,u?.quantityNotAvailableLabel||"The requested quantity is not available")))};const pe=function({content:e,children:t}){const[a,n]=(0,s.useState)(!1);return s.createElement("div",{className:"tooltip-container",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},a&&s.createElement("div",{className:"tooltip-content",dangerouslySetInnerHTML:{__html:e}}),t)};const _e=function({content:e}){const{cart:t,placeholders:a,priceDecimals:n}=(0,s.useContext)(g),r=t?.data?.extension_attributes?.cart?.extension_attributes?.surcharge,o=1===Number(r?.is_applied),i=e.checkoutOrderSummaryTitle?.replace("{{COUNT}}",t?.data?.items?.length),c=t?.data?.prices?.grand_total?.value??0,l=t?.data?.prices?.grand_total?.currency??"",d=t?.data?.prices?.subtotal_including_tax?.value??0,m=(t?.data?.prices?.applied_taxes??[]).reduce(((e,t)=>e+(t.amount.value??0)),0),u=t?.data?.prices?.discount?.amount?.value,p=me({price:d,priceDecimals:n,currency:l}),_=me({price:u,priceDecimals:n,currency:l}),h=me({price:c,priceDecimals:n,currency:l}),v=me({price:r?.amount,priceDecimals:n,currency:l}),y=t?.data?.extension_attributes?.totals?.total_segments?.find((e=>"aura_payment"===e?.code)),b=t?.data?.extension_attributes?.totals?.total_segments?.find((e=>"balance_payable"===e?.code)),f=me({price:y?.value,priceDecimals:n,currency:l}),E=me({price:b?.value,priceDecimals:n,currency:l}),w=(0,s.useMemo)((()=>`<div className="applied-discounts-title">${a.discountTooltipMessageApplied}</div>`),[t]);return s.createElement("div",null,s.createElement("div",{className:"checkout-order-summary-title"},s.createElement("span",null,i)),s.createElement("div",{className:"checkout-order-summary-wrapper"},s.createElement("div",{id:"checkout-items",className:"checkout-items-list-container"},t?.data?.items?.length&&t?.data?.items?.map((e=>s.createElement(ue,{key:e?.id,product:e,currency:t?.data?.prices?.grand_total?.currency,checkoutHideSection:!0})))),s.createElement("div",{className:"checkout-subtotal-container"},s.createElement("div",{className:"checkout-subtotal-wrapper"},s.createElement("div",{className:"checkout-subtotal"},s.createElement("div",{className:"checkout-subtotal-line"},s.createElement("div",{className:"checkout-subtotal-label"},a?.subTotalLabel),s.createElement("div",{className:"checkout-subtotal-price"},p)),o&&s.createElement("div",{className:"checkout-subtotal-line"},s.createElement("div",{className:"checkout-subtotal-label"},a?.cashOnDeliveryLabel),s.createElement("div",{className:"checkout-subtotal-price"},v)),s.createElement("div",{className:"checkout-subtotal-line"},s.createElement("div",{className:"checkout-subtotal-label"},a?.deliveryLabel),s.createElement("div",{className:"checkout-subtotal-price"},s.createElement("span",{className:"checkout-subtotal-amount"},a?.shippingMethodFreeLabel))),u<0&&s.createElement("div",{className:"checkout-subtotal-line"},s.createElement("label",{"aria-label":"discount",className:"discount-label"},a?.discountsLabel,s.createElement(pe,{content:w},s.createElement(P,{name:"info-blue",className:"discount-icon"}))),s.createElement("label",{"aria-label":"value",className:"discount-label"},_))),s.createElement("div",{className:"checkout-order-total"},f>0&&s.createElement("div",{className:"checkout-subtotal-line"},s.createElement("div",{className:"checkout-subtotal-label"},a?.paidWithAuraLabel),s.createElement("div",{className:"checkout-subtotal-price"},s.createElement("span",{className:"checkout-subtotal-amount"},f))),E>0&&s.createElement("div",{className:"checkout-subtotal-line"},s.createElement("div",{className:"checkout-subtotal-label"},a?.balancePaymentLabel),s.createElement("div",{className:"checkout-subtotal-price"},s.createElement("span",{className:"checkout-subtotal-amount"},E))),s.createElement("div",{className:"checkout-order-total-sec1"},s.createElement("div",{className:"checkout-order-total-label"},a?.orderTotalLabel),s.createElement("div",{className:"checkout-order-total-price"},h)),s.createElement("div",{className:"checkout-order-total-sec2"},s.createElement("label",{className:"excluding_label","aria-label":"excluding"},a.excludingDelivery),m>0&&s.createElement("label",{className:"excluding_label"},a.inclusiveVat)))))))},he=async()=>{let e=[];try{const t=`query {\n      Commerce_CheckoutComUpApiConfig ${x.CHECKOUTCOM_CONFIG_QUERY}\n    }`;await C(t,{},!0).then((t=>{e=t.response.data.Commerce_CheckoutComUpApiConfig}))}catch(e){console.error("Error while fetching the checkoutcomUpi config:",e)}return e},ve={config:{},binConfig:{enableValidation:!1,supportedPaymentMethods:""},cardBinNumbers:{},cardConfig:{cvv:"",expiry:"",number:"",cardType:"",tokenizedCard:"",selectedCard:"new",numberValid:!1,expiryValid:!1,cvvValid:!1,tokenizedCards:[]},processMada:!1,applePayAllowedIn:"all"},ye=(0,s.createContext)(ve);function ge(e){const[t,a]=(0,s.useState)(ve.config),[n,r]=(0,s.useState)([]),[o,i]=(0,s.useState)(ve.processMada),[c,l]=(0,s.useState)(ve.cardConfig),[d]=(0,s.useState)(ve.applePayAllowedIn),[m]=(0,s.useState)(ve.binConfig);return(0,s.useEffect)((()=>{(async()=>{try{const e=await he();a(e)}catch(e){console.error("Failed to fetch checkoutcomUpi config",e)}})()}),[]),(0,s.useEffect)((()=>{const e=t?.allowed_card_types;if(e){const t=e.toLowerCase().split(","),a=Object.entries({mastercard:"mastercard",visa:"visa","american express":"amex","diners club international":"diners"}),n=[];t.length>0&&Object.keys(a).length>0&&a.forEach((([e,a])=>{const s=t.indexOf(e);-1!==s&&(n[e]=a||"",t.splice(s,1))}));let s=Object.values(n).filter((e=>""!==e));t.length>0&&(s=s.concat(t));const o=s.indexOf("mada");-1!==o&&s.splice(o,1),r(s),i(t.includes("mada"))}}),[i,r,t]),s.createElement(ye.Provider,{value:{checkoutComUpiConfig:t,setCheckoutComUpiConfig:a,checkoutComUpiBinConfig:m,cardConfig:c,setCardConfig:l,allowedCardTypes:n,processMada:o,applePayAllowedIn:d}},e?.children)}const be=ye,fe=(0,s.forwardRef)(((e,t)=>{let a;const{cart:n}=e,{checkoutComUpiConfig:r}=(0,s.useContext)(be),o=async e=>{const t=`${await c("commerce-base-endpoint")}/${await c("appbuilder-apple-pay-endpoint")}`,n={method:"POST",headers:{"Content-Type":"application/json",Referrer:window.location.origin}};n.body=JSON.stringify({data:{apple_pay_gateway:e.validationURL,brand_name:await c("brand")}}),await fetch(t,n).then((e=>{a.completeMerchantValidation(e)})).catch((e=>{console.error(e)}))},i=async e=>{const t=r.api_url,{token:n}=e.payment,s={type:"applepay",token_data:{version:n.paymentData.version,data:n.paymentData.data,signature:n.paymentData.signature,header:{ephemeralPublicKey:n.paymentData.header.ephemeralPublicKey,publicKeyHash:n.paymentData.header.publicKeyHash,transactionId:n.transactionIdentifier}}},o={method:"POST",headers:{"Content-Type":"application/json",Authorization:r.public_key},body:JSON.stringify({params:s})};await fetch(t,o).then((e=>{if(void 0===e.data.type||"applepay"!==e.data.type)throw new Error(e.data.error_message);e.data.token,e.data.bin,e.data.type,e.data.expires_on,e.data.expiry_month,e.data.expiry_year,e.data.last4})).catch((e=>{console.error(e),a.completePayment(window.ApplePaySession.STATUS_FAILURE)}))},l=async e=>{let t=r.apple_pay_supported_networks.split(",");(()=>{for(let e=6;e>1;e--)if(window.ApplePaySession.supportsVersion(e))return e;return 1})()<5&&(t=t.filter((e=>"mada"!==e)));const n={merchantIdentifier:r.apple_pay_merchant_id,currencyCode:await c("currency"),countryCode:await c("country-code"),total:{label:"H&M QA",amount:e},supportedNetworks:t,merchantCapabilities:r.apple_pay_merchant_capabilities.split(",")};try{a=new window.ApplePaySession(1,n),a.onvalidatemerchant=o,a.onpaymentauthorized=i,a.begin()}catch(e){console.error(e)}};(0,s.useImperativeHandle)(t,(()=>({completePurchase:()=>{(async()=>{try{const e=n.data.prices.grand_total.value;l(e)}catch(e){}})()}})))}));const Ee=function(e){const{methodCode:t,method:a,onChangePaymentMethod:n,cart:r,paymentRef:o}=e;return s.createElement("div",{className:`payment-method fadeInUp payment-method-${a.code}`,onClick:e=>{e.stopPropagation(),n(a.code)},role:"button",tabIndex:"0",onKeyUp:e=>"Enter"===e.key&&n(a.code)},s.createElement("div",{className:"payment-method-top-panel"},s.createElement("div",{className:"payment-method-card"},s.createElement("input",{id:`payment-method-${t}`,className:"payment-method-radio",type:"radio",checked:a.isSelected,value:t,name:"payment-method",onChange:()=>n(a.code)}),s.createElement("label",{className:"radio-sim radio-label",htmlFor:`payment-method-${t}`},a.title),s.createElement("span",{dangerouslySetInnerHTML:{__html:a.icon.innerHTML}})),a.isSelected&&"checkout_com_upapi_applepay"===a.code?s.createElement(ge,null,s.createElement(fe,{ref:o,cart:r})):""))};const we=function({paymentMethods:e,paymentRef:t}){const[a,n]=(0,s.useState)([]),{cart:r,placeholders:o}=(0,s.useContext)(g);return(0,s.useEffect)((()=>{const t=r.data.available_payment_methods||[];if(e){let a=[];Object.values(e).forEach((e=>{const[n,s,r,o]=e.querySelectorAll("td");if(t.find((e=>e.code===n.innerHTML))){const e={};s.innerHTML&&(e.isSelected=!0),e.icon=o,e.code=n.innerHTML;const t=r.querySelectorAll("p");if(t.length){const[a,...n]=t;e.title=a.innerHTML,e.body=n}else e.title=r.innerHTML;a=a.concat(e)}})),n(a)}}),[e]),s.createElement("div",{id:"spc-payment-methods",className:"spc-checkout-payment-options fadeInUp"},s.createElement("div",{className:"spc-checkout-section-title fadeInUp payment-method-title"},o?.paymentMethodsTitle),Array.from(a).map((e=>s.createElement(Ee,{key:e.code,method:e,onChangePaymentMethod:e=>function(e){const t=a.map((t=>(t.code===e?t.isSelected=!0:t.isSelected=!1,t)));n(t)}(e),paymentRef:t,cart:r}))))};const Ne=function(){const{cart:e,placeholders:t,deliveryInformation:a,setDeliveryInformation:n,setEditAddress:r}=(0,s.useContext)(g),{billingAddressTitle:o="Billing Address"}=t,i=e?.data?.extension_attributes?.cart?.billing_address;return!([]?.find((e=>"cashondelivery"===e.code))?.isSelected||!1)&&i?.firstname?s.createElement("div",{className:"checkout__billing-information"},s.createElement("div",{className:"checkout__billing-information-title"},o),s.createElement("div",{className:"checkout__billing-information-wrapper"},s.createElement("div",{className:"checkout__billing-information__header"},s.createElement(q,{shippingAddress:i,placeholders:t,handleChangeClick:()=>(r(i),void n({...a,isDialogOpen:!0,isModalVisible:!0,changeAddress:"billing"}))})))):null};const ke=function({purchasePolicyText:e,paymentRef:t}){const{placeholders:a}=(0,s.useContext)(g);return s.createElement("div",{className:"complete_purchase_container"},s.createElement("div",{className:"checkbox_confirm_text"},s.createElement("input",{className:"checkbox_purchase",type:"checkbox"}),s.createElement("span",null,a.completePurchaseCheckbox)),s.createElement("div",null,s.createElement("p",{className:"purchase_policy_text"}," ",s.createElement("span",{dangerouslySetInnerHTML:{__html:e}})," ")),s.createElement("button",{id:"cardPayButton",type:"button",onClick:()=>t.current.completePurchase(),className:"complete_purchase_click"},s.createElement("span",{className:"text"},a.completePurchaseButton)))};const Ce=function({content:e}){const[t,a]=(0,s.useState)("home_delivery"),n=(0,s.useRef)();return s.createElement("div",{className:"checkout__shopping-block"},s.createElement("div",{className:"checkout__container"},s.createElement(Y,{onSelectedMethodChange:a}),"home_delivery"===t?s.createElement(X,null):null,s.createElement(we,{paymentMethods:e.paymentMethods,paymentRef:n}),s.createElement(Ne,null),s.createElement(ke,{purchasePolicyText:e.purchasePolicyText,paymentRef:n})),s.createElement("div",{className:"order-summary-container"},s.createElement(_e,{isAddress:!0,isCOD:"home_delivery"===t,content:e})))};const Se=function(){const{placeholders:e}=(0,s.useContext)(g);return(0,s.useEffect)((()=>{const e=document.querySelector(".cart-container"),t=document.querySelector(".cart.block"),a=document.querySelector(".cart-container .carousel-wrapper");return e&&e.classList.add("cart-container-full"),t&&t.classList.add("empty-cart-block"),a&&a.classList.add("carousel-empty-cart"),()=>{e&&e.classList.remove("cart-container-full"),t&&t.classList.remove("empty-cart-block"),a&&a.classList.remove("carousel-empty-cart")}}),[]),s.createElement("div",{className:"cart__empty"},s.createElement("span",{className:"cart-empty__title"},e.emptyCartMessage),s.createElement("span",{className:"cart-empty__recomendation-title"},e.emptyCartFavMessage))};const Ae=function({content:e}){T();const{activeProgressStep:t}=(0,s.useContext)(g),{cartId:a,cart:n}=(0,s.useContext)(g),r=n?.data?.items;return n.isLoading?s.createElement(O,null):a&&r?.length?s.createElement(s.Fragment,null,s.createElement(E,null),s.createElement("div",{className:"cart__checkout__blocks"},t===p.CHECKOUT_STEP&&s.createElement(Ce,{content:e}))):s.createElement(Se,null)};const Ie=async function(e="default",t=""){window.placeholders=window.placeholders||{};const a=e+t;return window.placeholders[a]||(window.placeholders[a]=new Promise((n=>{fetch(`${"default"===e?"":e}/placeholders.json${t?`?${t}`:""}`).then((e=>e.ok?e.json():{})).then((e=>{const t={};e.data.filter((e=>e.Key)).forEach((e=>{t[(0,b.toCamelCase)(e.Key)]=e.Text})),window.placeholders[a]=t,n(window.placeholders[a])})).catch((()=>{window.placeholders[a]={},n(window.placeholders[a])}))}))),window.placeholders[a]};async function xe(e){const t=document.documentElement.lang,a=await Ie(t?`/${t}`:"","sheet=cart"),n=(0,r.H)(e),[o,i,c,,l,d]=e.querySelectorAll(".checkout > div"),m=o?.querySelectorAll("p"),u=i?.querySelectorAll("li"),p=c?.querySelector("p"),h=c?.querySelectorAll("li"),[,...v]=d?.querySelectorAll("div > table > tbody > tr")||[],g=l?.querySelectorAll("div")[0],b=g?.querySelector("strong");let f={mobilecarttitle:"",carttitle:"",freereturnlable:"",standard_delivery:"",sameday_delivery:"",click_collect:"",cardmethodtitle:"",paymentlogolist:null,paymentMethods:"",checkoutOrderSummaryTitle:""};const[E,w,N]=m??[];f={mobilecarttitle:E?E.innerHTML:"",carttitle:w?w.innerText:"",freereturnlable:N?N.innerHTML:"",cardmethodtitle:p?p.innerHTML:"",paymentlogolist:h,deliverymethods:u,paymentMethods:v,checkoutOrderSummaryTitle:b?b?.innerHTML:""},n.render(s.createElement(y,{placeholders:{..._,...a}},s.createElement(Ae,{content:f})))}}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return a[e](r,r.exports,s),r.exports}s.m=a,t=[],s.O=(e,a,n,r)=>{if(!a){var o=1/0;for(d=0;d<t.length;d++){for(var[a,n,r]=t[d],i=!0,c=0;c<a.length;c++)(!1&r||o>=r)&&Object.keys(s.O).every((e=>s.O[e](a[c])))?a.splice(c--,1):(i=!1,r<o&&(o=r));if(i){t.splice(d--,1);var l=n();void 0!==l&&(e=l)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[a,n,r]},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={checkout:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[o,i,c]=a,l=0;if(o.some((t=>0!==e[t]))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(c)var d=c(s)}for(t&&t(a);l<o.length;l++)r=o[l],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},a=self.webpackChunk_adobe_aem_boilerplate=self.webpackChunk_adobe_aem_boilerplate||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=s.O(void 0,["vendor"],(()=>s(679))),o=(r=s.O(r)).A;export{o as default};